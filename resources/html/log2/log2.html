<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html;charset=utf-8" />
    <link rel="stylesheet" type="text/css" href="{{pluResPath}}/html/log/log.css" />
    <link rel="preload" href="../../font/tttgbnumber.ttf" as="font" />
    <link rel="shortcut icon" href="#" />
    <title>{{log}}</title>
    <style>
      /* 基础样式优化 */
      body {
        background-color: #f8f9fa;
        font-family: 'tttgbnumber', sans-serif;
        padding: 15px;
      }
      #fight {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 15px;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      }
      #fight div {
        padding: 10px 15px;
        border-bottom: 1px dashed #ccc;
        font-size: 15px;
        line-height: 1.5;
      }
      #fight div:last-child {
        border-bottom: none;
      }
    </style>
  </head>
  <body>
    <div id="fight"></div>

    <script>
function safeMessage(msg) {
  return msg
    .replace(/\\n/g, '<br>')      // 先转换换行符
    .replace(/\\/g, '')          // 再移除其他反斜杠
    .replace(/[\][+]/g, '')      // 移除特殊符号
    .replace(/&/g, '&amp;')      // HTML转义
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;');
}

      // 处理日志消息
      var fightmsg = document.title.split(',');
      var container = document.getElementById('fight');
      
      // 使用文档片段提升性能
      var fragment = document.createDocumentFragment();
      
      for (let i = 0; i < fightmsg.length; i++) {
        var div = document.createElement('div');
        div.innerHTML = safeMessage(fightmsg[i]);
        fragment.appendChild(div);
      }
      
      container.appendChild(fragment);
    </script>
  </body>
</html>