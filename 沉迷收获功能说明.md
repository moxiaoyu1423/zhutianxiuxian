# 沉迷收获功能说明

## 功能概述
新增了沉迷收获功能，用于查看沉迷活动的详细信息和收获情况。

## 新增指令

### 1. #沉迷收获
查看当前或最近一次沉迷活动的详细信息，包括：
- 沉迷地点和类型
- 沉迷次数进度
- 死亡次数
- 获得的修为和血气
- 开始和结束时间
- 获得的道具列表
- 活动状态

### 2. #清除沉迷记录
清除已完成的沉迷记录（仅限已完成的沉迷活动）

## 功能特点

1. **实时记录**：从沉迷开始就记录所有信息
2. **详细统计**：包含修为、血气、道具、死亡次数等全面数据
3. **时间追踪**：记录开始时间、结束时间和持续时长
4. **状态管理**：区分进行中和已完成状态
5. **数据清理**：提供清除已完成记录的功能

## 数据结构

沉迷历史记录包含以下字段：
- `start_time`: 开始时间戳
- `location`: 沉迷地点名称
- `location_type`: 地点类型（秘境、下界八域、九天十地、遮天位面、禁地、仙境）
- `total_count`: 总沉迷次数
- `settled_count`: 已结算次数
- `death_count`: 死亡次数
- `xiuwei_gained`: 获得的总修为
- `xueqi_gained`: 获得的总血气
- `items_gained`: 获得的道具列表
- `status`: 状态（in_progress/completed）
- `end_time`: 结束时间戳（完成后）

## 使用示例

```
#沉迷收获
```

输出示例：
```
【沉迷收获详情】
━━━━━━━━━━━━━━━━━━━━━━
沉迷地点：永恒海
地点类型：秘境
沉迷次数：50/50
死亡次数：3
获得修为：125,000
获得血气：80,000
开始时间：2024-01-15 14:30:25
结束时间：2024-01-15 16:45:30
持续时间：2小时15分钟
状态：已完成
获得物品：
   1. [地心红莲] x15
   2. [圣品真器丹] x8
   3. [绝天白灵芝] x12
━━━━━━━━━━━━━━━━━━━━━━
💡 提示：可以发送"#清除沉迷记录"来清除本次记录
```

## 技术实现

1. **数据存储**：使用Redis存储沉迷历史数据
2. **实时更新**：每次结算时更新历史记录
3. **状态同步**：沉迷完成时自动更新状态
4. **错误处理**：包含完整的错误检查和提示

## 支持的沉迷类型

- 秘境历练
- 下界八域历练  
- 九天十地历练
- 遮天位面历练
- 禁地历练
- 仙境镇守

所有沉迷类型都支持完整的收获记录功能。